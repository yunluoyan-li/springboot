# 前后端分离实现说明

## 概述

本项目已成功实现前后端分离架构，将原有的单体应用拆分为独立的RESTful API后端和现代化前端应用。

## 架构设计

### 后端架构
- **技术栈**: Spring Boot + MyBatis + MySQL
- **API设计**: RESTful风格
- **认证方式**: Session-based认证
- **跨域支持**: CORS配置
- **响应格式**: 统一JSON格式

### 前端架构
- **技术栈**: HTML5 + CSS3 + JavaScript (ES6+)
- **UI框架**: Bootstrap 5
- **图标库**: Font Awesome
- **HTTP客户端**: Fetch API
- **状态管理**: 原生JavaScript

## 目录结构

```
pet_adoption_db/
├── src/main/java/com/example/petadoption/
│   ├── controller/
│   │   ├── api/                    # 新增：RESTful API控制器
│   │   │   ├── PetApiController.java
│   │   │   ├── UserApiController.java
│   │   │   └── AdoptionApiController.java
│   │   └── ...                     # 原有控制器（保留）
│   ├── config/
│   │   ├── CorsConfig.java         # 新增：CORS配置
│   │   └── SecurityConfig.java     # 原有安全配置
│   └── ...
├── frontend/                       # 新增：前端应用
│   ├── index.html                  # 主页面
│   ├── css/
│   │   └── style.css              # 样式文件
│   └── js/
│       ├── api.js                 # API调用模块
│       └── app.js                 # 应用主逻辑
└── ...
```

## API接口设计

### 1. 用户管理API (`/api/users`)

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| POST | `/login` | 用户登录 | 公开 |
| POST | `/register` | 用户注册 | 公开 |
| POST | `/logout` | 用户登出 | 登录用户 |
| GET | `/current` | 获取当前用户 | 登录用户 |
| GET | `/` | 获取所有用户 | 管理员 |
| PUT | `/{id}` | 更新用户信息 | 用户本人/管理员 |
| DELETE | `/{id}` | 删除用户 | 管理员 |

### 2. 宠物管理API (`/api/pets`)

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| GET | `/` | 获取宠物列表 | 公开 |
| GET | `/{id}` | 获取宠物详情 | 公开 |
| POST | `/` | 创建宠物 | 管理员 |
| PUT | `/{id}` | 更新宠物 | 管理员 |
| DELETE | `/{id}` | 删除宠物 | 管理员 |
| GET | `/stats` | 获取统计数据 | 公开 |
| GET | `/breeds` | 获取宠物品种 | 公开 |

### 3. 领养申请API (`/api/adoption`)

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| GET | `/applications` | 获取所有申请 | 管理员 |
| GET | `/my-applications` | 获取我的申请 | 登录用户 |
| GET | `/check-application/{petId}` | 检查是否已申请 | 登录用户 |
| POST | `/apply` | 提交申请 | 登录用户 |
| GET | `/application/{id}` | 获取申请详情 | 用户本人/管理员 |
| POST | `/approve/{id}` | 审批通过 | 管理员 |
| POST | `/reject/{id}` | 审批拒绝 | 管理员 |
| DELETE | `/application/{id}` | 删除申请 | 管理员 |
| GET | `/stats` | 获取申请统计 | 管理员 |

## 响应格式

### 成功响应
```json
{
    "success": true,
    "message": "操作成功",
    "data": {
        // 具体数据
    }
}
```

### 错误响应
```json
{
    "success": false,
    "message": "错误信息"
}
```

## 前端功能特性

### 1. 用户认证
- ✅ 用户登录/注册
- ✅ 会话管理
- ✅ 权限控制
- ✅ 自动登录检查

### 2. 宠物管理
- ✅ 宠物列表展示
- ✅ 搜索和筛选
- ✅ 分页导航
- ✅ 宠物详情查看
- ✅ 添加宠物（管理员）

### 3. 领养申请
- ✅ 申请领养
- ✅ 查看申请状态
- ✅ 申请历史
- ✅ 防重复申请

### 4. 管理功能
- ✅ 申请审批
- ✅ 用户管理
- ✅ 统计数据

### 5. UI/UX特性
- ✅ 响应式设计
- ✅ 现代化界面
- ✅ 加载动画
- ✅ 消息提示
- ✅ 空状态处理

## 部署说明

### 后端部署

1. **编译项目**
```bash
mvn clean package
```

2. **运行应用**
```bash
java -jar target/pet-adoption-system-0.0.1-SNAPSHOT.jar
```

3. **访问API**
```
http://localhost:8080/api/
```

### 前端部署

1. **静态文件部署**
   - 将 `frontend/` 目录下的文件部署到Web服务器
   - 支持Apache、Nginx、IIS等

2. **本地开发**
   - 使用Live Server插件（VS Code）
   - 或使用Python简单服务器：
     ```bash
     cd frontend
     python -m http.server 3000
     ```

3. **访问前端**
```
http://localhost:3000
```

## 开发指南

### 添加新的API接口

1. **创建控制器方法**
```java
@GetMapping("/new-endpoint")
public ResponseEntity<Map<String, Object>> newEndpoint() {
    // 实现逻辑
    Map<String, Object> response = new HashMap<>();
    response.put("success", true);
    response.put("data", result);
    return ResponseEntity.ok(response);
}
```

2. **前端API调用**
```javascript
// 在 api.js 中添加
const newAPI = {
    getData: async () => {
        return apiRequest('/new-endpoint');
    }
};
```

3. **前端页面集成**
```javascript
// 在 app.js 中调用
async function loadNewData() {
    try {
        const response = await newAPI.getData();
        if (response.success) {
            // 处理数据
        }
    } catch (error) {
        Utils.showMessage('加载失败', error.message, 'error');
    }
}
```

### 样式定制

1. **修改主题色彩**
```css
:root {
    --primary-color: #667eea;
    --secondary-color: #764ba2;
}
```

2. **添加新组件样式**
```css
.new-component {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
}
```

## 安全考虑

### 1. CORS配置
- 已配置允许跨域请求
- 支持credentials
- 限制API路径

### 2. 认证授权
- Session-based认证
- 角色权限控制
- API权限验证

### 3. 数据验证
- 前端表单验证
- 后端参数校验
- SQL注入防护

## 性能优化

### 1. 前端优化
- 图片懒加载
- 分页加载
- 缓存策略
- 压缩资源

### 2. 后端优化
- 数据库索引
- 连接池配置
- 缓存机制
- 异步处理

## 测试建议

### 1. API测试
- 使用Postman测试API接口
- 验证响应格式
- 测试错误处理

### 2. 前端测试
- 浏览器兼容性测试
- 响应式布局测试
- 用户交互测试

### 3. 集成测试
- 前后端联调
- 跨域请求测试
- 会话管理测试

## 扩展建议

### 1. 技术栈升级
- 前端：Vue.js/React
- 后端：Spring Boot 3.x
- 数据库：PostgreSQL

### 2. 功能扩展
- 文件上传
- 消息通知
- 数据导出
- 报表统计

### 3. 部署优化
- Docker容器化
- CI/CD流水线
- 负载均衡
- 监控告警

## 总结

通过前后端分离架构的实现，系统获得了以下优势：

1. **开发效率提升**: 前后端独立开发，并行协作
2. **技术栈灵活**: 前端可独立选择技术栈
3. **部署灵活**: 前后端可独立部署和扩展
4. **用户体验**: 现代化的单页应用体验
5. **维护性**: 清晰的代码结构和职责分离

这种架构为系统的后续扩展和维护提供了良好的基础。 